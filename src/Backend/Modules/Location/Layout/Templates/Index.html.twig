{# This file is generated by the Spoon2Twig Converter #}

{% include "/Layout/Templates/Head.html.twig" %}
{% include "/Layout/Templates/StructureStartModule.html.twig" %}
<div class="row fork-module-heading">
  <div class="col-md-12">
    <h2>{{ 'lbl.Location'|trans|capitalize }}</h2>
    {% if showLocationAdd %}
    <div class="btn-toolbar pull-right">
      <div class="btn-group" role="group">
        <a href="{{ geturl('add' ) }}" class="btn btn-default" title="{{ 'lbl.Add'|trans|capitalize }}">
          <span class="glyphicon glyphicon-plus"></span>
          {{ 'lbl.Add'|trans|capitalize }}
        </a>
      </div>
    </div>
    {% endif %}
  </div>
</div>
{% if dataGrid %}
<div class="row fork-module-content">
  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          {{ 'lbl.Map'|trans|capitalize }}
        </h3>
      </div>
      <div class="panel-body">
        {% if items %}
        <div id="map" style="width: 100%; height: {{ settings.height }}px;"></div>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">
          {{ 'lbl.Settings'|trans|capitalize }}
        </h3>
      </div>
      <div class="panel-body">
        <div class="form-group">
          <label for="zoomLevel">{{ 'lbl.ZoomLevel'|trans|capitalize }}</label>
          {% form_field_error zoom_level %} {% form_field zoom_level %}
        </div>
        <div class="form-group"{% if not godUser %} style="display:none;"{% endif %}>
          <label for="width">{{ 'lbl.Width'|trans|capitalize }}</label>
          <p class="text-info">{{ 'msg.WidthHelp'|trans|sprintf(300:800 ) }}</p>
          {% form_field_error width %} {% form_field width %}
        </div>
        <div class="form-group"{% if not godUser %} style="display:none;"{% endif %}>
          <label for="height">{{ 'lbl.Height'|trans|capitalize }}</label>
          <p class="text-info">{{ 'msg.HeightHelp'|trans|sprintf(150 ) }}</p>
          {% form_field_error height %} {% form_field height %}
        </div>
        <div class="form-group">
          <label for="mapType">{{ 'lbl.MapType'|trans|capitalize }}</label>
          {% form_field_error map_type %} {% form_field map_type %}
        </div>
        <div class="btn-toolbar">
          <div class="btn-group pull-right" role="group">
            <a href="#" id="saveLiveData" class="btn btn-primary">{{ 'lbl.Save'|trans|capitalize }}</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="row fork-module-content">
  <div class="col-md-12">
    {{ dataGrid }}
  </div>
</div>
{% endif %}
{% if not dataGrid %}
<div class="row fork-module-content">
  <div class="col-md-12">
    <p>{{ 'msg.NoItems'|trans|sprintf(geturl('add' ) ) }}</p>
  </div>
</div>
{% endif %}
<script type="text/javascript">
  //@todo BUG: data below should come from action
  var mapOptions = {
    zoom: '{{ settings.zoom_level }}' == 'auto' ? 0 : {{ settings.zoom_level }},
    type: '{{ settings.map_type }}',
    center: {
      lat: {{ settings.center.lat }},
      lng: {{ settings.center.lng }}
    }
  };
  var markers = [];
  {% for item in items %}
    {% if item.lat %}
      {% if item.lng %}
        markers.push({
          lat: {{ item.lat }},
          lng: {{ item.lng }},
          title: '{{ item.title }}',
          text: '<p>{{ item.street }} {{ item.number }}</p><p>{{ item.zip }} {{ item.city }}</p>'
        });
      {% endif %}
    {% endif %}
  {% endfor %}
</script>
{% include "/Layout/Templates/StructureEndModule.html.twig" %}
{% include "/Layout/Templates/Footer.html.twig" %}
